Namespace(batch_size=128, data_path='../mscoco', epoch1=28, epoch2=200, exp_mode='s2s', exp_name='diffusion_loop_test', feat_dim=1024, layer_num=3, learning_rate=0.0001, log_folder='./logs', patience=5, rank='0', resume_best=True, resume_last=False, seq_len=20, teacher_model_path='/s2s/tm_gt20_ce_entropy/s2s_best.pth', test=False, use_cache='True', use_loss_ce=True, use_loss_entropy=False, use_loss_kl=False, use_loss_l2=False, use_loss_word=True, workers=16)
2
1
Resuming from epoch 28, patience 0, validation loss 1.247229, and best cider 1.227287
Training starts
Epoch: 29, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8097950364486085, 0.6479707790396189, 0.49632919464172737, 0.37498056628084225], 'METEOR': 0.2762533771076071, 'ROUGE': 0.576432278706871, 'CIDEr': 1.2157922516929902}
Test scores {'BLEU': [0.8110629279177974, 0.6465704630281687, 0.4959436115083868, 0.3751525385443627], 'METEOR': 0.27478647419460644, 'ROUGE': 0.5741051885934286, 'CIDEr': 1.2278241873463114}
Epoch: 30, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8099204309987491, 0.648768197268518, 0.49749512548458624, 0.37625929300979083], 'METEOR': 0.2759972934466814, 'ROUGE': 0.5757779620887459, 'CIDEr': 1.2159933049124538}
Test scores {'BLEU': [0.8118914369169659, 0.6467388430529961, 0.4955871885636177, 0.37441041411101506], 'METEOR': 0.2741861186722312, 'ROUGE': 0.5740264367702556, 'CIDEr': 1.2230903523172936}
Epoch: 31, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8092099232814993, 0.6473155610264284, 0.4960591968689464, 0.3750806678146947], 'METEOR': 0.2756148268372193, 'ROUGE': 0.57636079207464, 'CIDEr': 1.2170953932470392}
Test scores {'BLEU': [0.809652694832577, 0.6458619216850302, 0.49541994860332467, 0.37436820857373937], 'METEOR': 0.2738775442851943, 'ROUGE': 0.5729921846166542, 'CIDEr': 1.2225275536663605}
Epoch: 32, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8104136091334408, 0.6485916334604481, 0.49705601773706864, 0.37615887106934925], 'METEOR': 0.2754485106957381, 'ROUGE': 0.5762152234464707, 'CIDEr': 1.220378217676684}
Test scores {'BLEU': [0.8104963771700269, 0.6461526146833303, 0.49464547097492023, 0.3736010933640518], 'METEOR': 0.27395180473323094, 'ROUGE': 0.5738686195264818, 'CIDEr': 1.2233212282397512}
Epoch: 33, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8111536926300777, 0.6495468685041133, 0.4973337793800541, 0.3759201726690816], 'METEOR': 0.27548701566637807, 'ROUGE': 0.5757476381476072, 'CIDEr': 1.2172220898802029}
Test scores {'BLEU': [0.8111673440319331, 0.6470549054064897, 0.49608637742895445, 0.37571371724579605], 'METEOR': 0.27355953405433886, 'ROUGE': 0.5733949875901111, 'CIDEr': 1.2248491747645636}
Epoch: 34, Learning Rate: 0.000020
Validation scores {'BLEU': [0.8100512546587184, 0.6487641903388416, 0.4970312331488311, 0.3752573587182001], 'METEOR': 0.2750180364298729, 'ROUGE': 0.5763639753118399, 'CIDEr': 1.2151630192620517}
Test scores {'BLEU': [0.8103932458074871, 0.6457073931909275, 0.49500817985203144, 0.3741206550367309], 'METEOR': 0.2734024985893119, 'ROUGE': 0.5736157254203463, 'CIDEr': 1.221366835442587}
patience reached.
