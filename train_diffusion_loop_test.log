Namespace(batch_size=128, data_path='../mscoco', epoch1=100, epoch2=200, exp_mode='s2s', exp_name='diffusion_loop_test', feat_dim=1024, layer_num=3, learning_rate=0.0001, log_folder='./logs', patience=5, rank='0', resume_best=False, resume_last=False, seq_len=20, teacher_model_path='/s2s/tm_gt20_ce_entropy/s2s_best.pth', test=False, use_cache='True', use_loss_ce=True, use_loss_entropy=False, use_loss_kl=False, use_loss_l2=False, use_loss_word=True, workers=16)
2
1
Training starts
Epoch: 0, Learning Rate: 0.000025
Validation scores {'BLEU': [0.7154515161541749, 0.529885113780834, 0.3754740348718267, 0.2640318844920457], 'METEOR': 0.23169278768873788, 'ROUGE': 0.5191525600979215, 'CIDEr': 0.8546344350146566}
Test scores {'BLEU': [0.7205612764243327, 0.5316228161942518, 0.3767807691752552, 0.2639515272439496], 'METEOR': 0.2325523837032063, 'ROUGE': 0.5217475346273547, 'CIDEr': 0.8597019898526054}
Epoch: 1, Learning Rate: 0.000050
Validation scores {'BLEU': [0.7536539272841388, 0.5667850699694992, 0.4100648188843656, 0.2946130889940548], 'METEOR': 0.23937143838643146, 'ROUGE': 0.5372009948664634, 'CIDEr': 0.9386948293942625}
Test scores {'BLEU': [0.7583694962376494, 0.5702829535224113, 0.4153683202327887, 0.3007077875284916], 'METEOR': 0.23966977303218906, 'ROUGE': 0.5375942844443967, 'CIDEr': 0.9608448720250473}
Epoch: 2, Learning Rate: 0.000075
Validation scores {'BLEU': [0.7472810213739787, 0.5616895344662653, 0.4056763624300765, 0.2913123618478134], 'METEOR': 0.23424867082384554, 'ROUGE': 0.5343466460607292, 'CIDEr': 0.931270171476249}
Test scores {'BLEU': [0.7493501592226173, 0.5627197695412265, 0.40754467808182054, 0.2953701296136736], 'METEOR': 0.23653787918431401, 'ROUGE': 0.5359523538838384, 'CIDEr': 0.9464503180093014}
Epoch: 3, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7454368151435737, 0.5654108940391258, 0.40950498627629955, 0.29590157847473064], 'METEOR': 0.23554407339212688, 'ROUGE': 0.538504400183061, 'CIDEr': 0.9303486936127326}
Test scores {'BLEU': [0.7443505145522097, 0.5649142663061361, 0.412666245105292, 0.30028882604596097], 'METEOR': 0.23647221740971322, 'ROUGE': 0.5373852687861556, 'CIDEr': 0.9464725148141985}
Epoch: 4, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7590358716346228, 0.5806579758812498, 0.42381358138326075, 0.3074710190579254], 'METEOR': 0.2443921369466751, 'ROUGE': 0.5472570632385209, 'CIDEr': 0.9777546782826088}
Test scores {'BLEU': [0.7557733834663236, 0.5752844387499941, 0.42090963364447337, 0.3060386412487119], 'METEOR': 0.24258759822935966, 'ROUGE': 0.5449282391322431, 'CIDEr': 0.9765868111347205}
Epoch: 5, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7691726200318614, 0.5960716129900269, 0.44450504133402124, 0.3279288034195755], 'METEOR': 0.2560480476958197, 'ROUGE': 0.555162571430221, 'CIDEr': 1.0421197979693286}
Test scores {'BLEU': [0.7679819463047006, 0.5935622997858994, 0.44277382429363243, 0.32705940399894723], 'METEOR': 0.2550935473393081, 'ROUGE': 0.5527354307693749, 'CIDEr': 1.0364493248145805}
Epoch: 6, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7832039702868432, 0.6118529998423866, 0.45807421745176696, 0.3390139890178249], 'METEOR': 0.2605441898461353, 'ROUGE': 0.5588068559944299, 'CIDEr': 1.091089649526546}
Test scores {'BLEU': [0.7804264832780342, 0.6071264138030109, 0.45563930132234093, 0.33792019550041275], 'METEOR': 0.2589564342193557, 'ROUGE': 0.5555063439658806, 'CIDEr': 1.0855418923663531}
Epoch: 7, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7856861918358301, 0.6172567515653686, 0.46465888774778996, 0.3462194960173033], 'METEOR': 0.2636354616564662, 'ROUGE': 0.5598390660974208, 'CIDEr': 1.117018462967129}
Test scores {'BLEU': [0.7872456231163173, 0.6157630248927715, 0.46386064276774414, 0.34548607704096945], 'METEOR': 0.2620051086703173, 'ROUGE': 0.5586433157385245, 'CIDEr': 1.1209330463657157}
Epoch: 8, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7894003479772983, 0.6223075099961712, 0.4703903761704986, 0.35106158868529125], 'METEOR': 0.2629012198711777, 'ROUGE': 0.5633241804849085, 'CIDEr': 1.1178400129185742}
Test scores {'BLEU': [0.7905317161106069, 0.6232045439514974, 0.4713425937240709, 0.35245320076926606], 'METEOR': 0.26323389618795856, 'ROUGE': 0.5644763363206784, 'CIDEr': 1.1271034724265256}
Epoch: 9, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7886372954329057, 0.6223383905620096, 0.47150831298935414, 0.35233423547162923], 'METEOR': 0.264712250849379, 'ROUGE': 0.5628270842806764, 'CIDEr': 1.114296596933163}
Test scores {'BLEU': [0.7879967083283755, 0.6202846508056764, 0.4688009290051688, 0.35045506599335385], 'METEOR': 0.2634832357181227, 'ROUGE': 0.5619685087718301, 'CIDEr': 1.1171172040251325}
Epoch: 10, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7931737543995618, 0.626363563535806, 0.4752923683284709, 0.3559443527987765], 'METEOR': 0.26681719896148387, 'ROUGE': 0.563126184026241, 'CIDEr': 1.141279142101075}
Test scores {'BLEU': [0.7935972077135683, 0.6260423551504821, 0.47607125750135293, 0.3574115978723568], 'METEOR': 0.2669645551221709, 'ROUGE': 0.563516220539089, 'CIDEr': 1.153615978453905}
Epoch: 11, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7973046327731269, 0.6321644489738489, 0.48036614877529105, 0.35995282756248453], 'METEOR': 0.27149835201351075, 'ROUGE': 0.5691282321097975, 'CIDEr': 1.1671323854845923}
Test scores {'BLEU': [0.7959866586450334, 0.6296953811666076, 0.47851304013534973, 0.3589346301473191], 'METEOR': 0.2692574766234341, 'ROUGE': 0.5648930226598714, 'CIDEr': 1.1686688464805397}
Epoch: 12, Learning Rate: 0.000100
Validation scores {'BLEU': [0.796906430857104, 0.6300314104119527, 0.4789482514210877, 0.3587259177108605], 'METEOR': 0.26870764426290855, 'ROUGE': 0.5655299721190339, 'CIDEr': 1.1488360028653475}
Test scores {'BLEU': [0.7980582257002451, 0.6315470867043838, 0.4806083235918013, 0.3604480696410986], 'METEOR': 0.2683310782490342, 'ROUGE': 0.5662077956789077, 'CIDEr': 1.1596730500827634}
Epoch: 13, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7972153236890742, 0.631555122838472, 0.4805903757504784, 0.3615310613072513], 'METEOR': 0.27033028199766246, 'ROUGE': 0.5674253756046861, 'CIDEr': 1.158433444403296}
Test scores {'BLEU': [0.7983228741218935, 0.6308891560714294, 0.47992150332812195, 0.3604558878193949], 'METEOR': 0.2683901961703468, 'ROUGE': 0.5668250142498178, 'CIDEr': 1.1629722569050913}
Epoch: 14, Learning Rate: 0.000100
Validation scores {'BLEU': [0.7991941736295436, 0.6357859692597365, 0.4858258632013416, 0.3665213493944182], 'METEOR': 0.2688035569086078, 'ROUGE': 0.5685989578437552, 'CIDEr': 1.163613868121136}
Test scores {'BLEU': [0.8000965161244443, 0.6343416783864908, 0.4833832056650141, 0.3633293063341922], 'METEOR': 0.268362122339554, 'ROUGE': 0.5677818973538296, 'CIDEr': 1.1666561255833872}
Epoch: 15, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8034608782230874, 0.6378238171660026, 0.48531803151400005, 0.36445828228295635], 'METEOR': 0.27156390782138357, 'ROUGE': 0.5688619214258285, 'CIDEr': 1.1853899523362987}
Test scores {'BLEU': [0.8057780797590185, 0.640178218714447, 0.4883090480275655, 0.36657311352866756], 'METEOR': 0.2710588020005937, 'ROUGE': 0.5695252496596827, 'CIDEr': 1.1944481644281464}
Epoch: 16, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8005886112490045, 0.6367884942647167, 0.48531893475318266, 0.3643312907075582], 'METEOR': 0.27013070782551885, 'ROUGE': 0.5683841642614081, 'CIDEr': 1.165298863990335}
Test scores {'BLEU': [0.8012977161287616, 0.6357967561519287, 0.48487492507994046, 0.3648034620953728], 'METEOR': 0.26945454561839177, 'ROUGE': 0.5661607302631959, 'CIDEr': 1.1732708745951768}
Epoch: 17, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8016079852001343, 0.6359095058961316, 0.48408165618436494, 0.363186928396061], 'METEOR': 0.2731389933785426, 'ROUGE': 0.5690379837723725, 'CIDEr': 1.1876043881843783}
Test scores {'BLEU': [0.8010335915455159, 0.6348774667589432, 0.48320868563325164, 0.36227789822826906], 'METEOR': 0.27247293794093, 'ROUGE': 0.5674035555854329, 'CIDEr': 1.1953321142507265}
Epoch: 18, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8040168243621852, 0.6418198358613835, 0.49113989627926197, 0.3699192245695924], 'METEOR': 0.2730861505545365, 'ROUGE': 0.571639322357513, 'CIDEr': 1.1924960868807601}
Test scores {'BLEU': [0.8020283617593672, 0.6371196500635282, 0.4861488259685563, 0.36674629721423047], 'METEOR': 0.2714797610850669, 'ROUGE': 0.5685029219065003, 'CIDEr': 1.1929948565189177}
Epoch: 19, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8047757159186011, 0.6423293561768079, 0.4909849516656918, 0.3700077398163983], 'METEOR': 0.2728852793496069, 'ROUGE': 0.5716268634805787, 'CIDEr': 1.1877260627708879}
Test scores {'BLEU': [0.8029718275384796, 0.6388404355776794, 0.4876191988814753, 0.3663880182486705], 'METEOR': 0.2709710956436763, 'ROUGE': 0.5692709369616766, 'CIDEr': 1.19088391967204}
Epoch: 20, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8039123380988211, 0.6394048550491042, 0.4887815205027258, 0.3682913787225509], 'METEOR': 0.2716123593319712, 'ROUGE': 0.5700635725210548, 'CIDEr': 1.1732812790147582}
Test scores {'BLEU': [0.8048888638786712, 0.6389465729447434, 0.48859823787037854, 0.368026330472083], 'METEOR': 0.2709828706135287, 'ROUGE': 0.5695992528825268, 'CIDEr': 1.193496605731591}
Epoch: 21, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8064416721570915, 0.6418043464920411, 0.48981369975121297, 0.3682147517839752], 'METEOR': 0.2730869158230754, 'ROUGE': 0.5726185704441398, 'CIDEr': 1.1923933115537668}
Test scores {'BLEU': [0.8062403985683353, 0.6403655320911279, 0.4885228359965839, 0.3673724949195764], 'METEOR': 0.2718126451887325, 'ROUGE': 0.5701373232845971, 'CIDEr': 1.205237854682921}
Epoch: 22, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8018429134631968, 0.6392735348724997, 0.4882550996833946, 0.36772642230035985], 'METEOR': 0.27312389467040443, 'ROUGE': 0.5714221297440879, 'CIDEr': 1.1915665244378726}
Test scores {'BLEU': [0.8058769096415505, 0.6422565708126727, 0.49171878546555703, 0.3707895120012019], 'METEOR': 0.27325835455803066, 'ROUGE': 0.5705943759417141, 'CIDEr': 1.2083002045150668}
Epoch: 23, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8042395168341102, 0.6422518390059498, 0.4909770755519498, 0.37000742868471914], 'METEOR': 0.27309701827482813, 'ROUGE': 0.5718211122797614, 'CIDEr': 1.1961138873761077}
Test scores {'BLEU': [0.8074137370986492, 0.643333826934747, 0.49293273047210895, 0.37280468374619563], 'METEOR': 0.2730241444829229, 'ROUGE': 0.5719511610887854, 'CIDEr': 1.2142634373906698}
Epoch: 24, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8040271417280255, 0.6408289340718126, 0.48928313539698565, 0.36836641981962004], 'METEOR': 0.27345126626826566, 'ROUGE': 0.5712331249948422, 'CIDEr': 1.1977161025349323}
Test scores {'BLEU': [0.8035355458571589, 0.640009261845529, 0.4891940086992237, 0.3687988931140145], 'METEOR': 0.27207523899532693, 'ROUGE': 0.5706544449047612, 'CIDEr': 1.2079443162598744}
Epoch: 25, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8084481084543591, 0.6454636384159331, 0.49467095233025493, 0.3735016718293763], 'METEOR': 0.2744044127875205, 'ROUGE': 0.5744403727777322, 'CIDEr': 1.2098191989550668}
Test scores {'BLEU': [0.8095301878728656, 0.6447739808405947, 0.4939809675034363, 0.37308127624810866], 'METEOR': 0.27331844176254116, 'ROUGE': 0.5732274171318293, 'CIDEr': 1.2151768941021301}
Epoch: 26, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8066085155835552, 0.6428555290937302, 0.4908413221951747, 0.368976536566231], 'METEOR': 0.27431468658155467, 'ROUGE': 0.5724036359844542, 'CIDEr': 1.1959069875207409}
Test scores {'BLEU': [0.8074850104980453, 0.6424703364619533, 0.49225967808960336, 0.37137169535193293], 'METEOR': 0.2737046886604215, 'ROUGE': 0.5708271444106028, 'CIDEr': 1.2144806587701}
Epoch: 27, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8063885859433297, 0.6438944069210628, 0.4931304120396768, 0.371964630233302], 'METEOR': 0.2742974815556434, 'ROUGE': 0.5752262932827018, 'CIDEr': 1.2074347908944605}
Test scores {'BLEU': [0.8081654836793559, 0.6428212369236762, 0.49267556562061654, 0.3720706595033815], 'METEOR': 0.2728182337164654, 'ROUGE': 0.5718661892019469, 'CIDEr': 1.2115622648073323}
Epoch: 28, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8103753686629191, 0.6480048358885804, 0.4954477170160712, 0.3735980606474595], 'METEOR': 0.27502789568767916, 'ROUGE': 0.5758859679301183, 'CIDEr': 1.2119376774299362}
Test scores {'BLEU': [0.8110287450297783, 0.6464680466543735, 0.49591925892842575, 0.3750710868106744], 'METEOR': 0.2739844439560272, 'ROUGE': 0.5741590864544787, 'CIDEr': 1.2272865794324739}
Epoch: 29, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8069102159178009, 0.6449095752805972, 0.4943098582027539, 0.37396147985267125], 'METEOR': 0.2742141722265518, 'ROUGE': 0.5742906157909925, 'CIDEr': 1.2071792453903016}
Test scores {'BLEU': [0.808375497253229, 0.643359970190845, 0.4926871804152112, 0.37239659919470436], 'METEOR': 0.2733304824794567, 'ROUGE': 0.5727008507148106, 'CIDEr': 1.2117389586995644}
Epoch: 30, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8051660056194988, 0.6428751191408544, 0.491417843454872, 0.37025946637300977], 'METEOR': 0.2733516237761465, 'ROUGE': 0.5724839452358685, 'CIDEr': 1.203739398826287}
Test scores {'BLEU': [0.8080532909795549, 0.6425763357790819, 0.4923629925482936, 0.3716601128697178], 'METEOR': 0.27244364055716136, 'ROUGE': 0.5716016907937441, 'CIDEr': 1.2126697694493447}
Epoch: 31, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8077255693722234, 0.6443165733376245, 0.4919618854908974, 0.37060706719663966], 'METEOR': 0.27434907327551405, 'ROUGE': 0.5737312682885602, 'CIDEr': 1.2052496822386642}
Test scores {'BLEU': [0.8100603489193131, 0.644664915274055, 0.4937096482746098, 0.3732706055347905], 'METEOR': 0.2739686084535065, 'ROUGE': 0.5723722510095948, 'CIDEr': 1.221932280278556}
Epoch: 32, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8049737561874308, 0.6422722334622145, 0.49101949710283105, 0.3700688337195351], 'METEOR': 0.27387042142267093, 'ROUGE': 0.5719727271236339, 'CIDEr': 1.1983547618728665}
Test scores {'BLEU': [0.8089992208466625, 0.6433692012226411, 0.49230322715919617, 0.37100764552109106], 'METEOR': 0.27368183738819163, 'ROUGE': 0.5716653962183654, 'CIDEr': 1.2133855914651532}
Epoch: 33, Learning Rate: 0.000100
Validation scores {'BLEU': [0.8078462797980314, 0.6450999791670545, 0.4940727987455352, 0.3732606786665734], 'METEOR': 0.27403073439660686, 'ROUGE': 0.5733548956932663, 'CIDEr': 1.2096873678969777}
Test scores {'BLEU': [0.8088111560906571, 0.644680022952433, 0.49341445797308753, 0.3725085140057724], 'METEOR': 0.27331859967765115, 'ROUGE': 0.5715915934805078, 'CIDEr': 1.2159607282500986}
patience reached.
